{% extends 'cheap_pints/base.html' %}
{% load staticfiles %}

{% block title_block %}
Home
{% endblock %}

{% block body_block %}
<div class="jumbotron p-4">
    <div class="container">
        <div>
            <h2 class="h2">
                {{ bar.barName }}
            </h2>
        </div>
    </div>
    </div>
<div class="container">
  <div class="row">
    <div class="col-sm-12 col-md-6">
      <div class="custom-column">
        <img class="card-img-top"
            style="width: 100%;"
            {% if bar.image_reference %}
            src="https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference={{ bar.image_reference }}&key={{ api_key }}"
            {% else %}
            src="https://cdn.pixabay.com/photo/2017/05/05/19/33/beer-2288121_1280.jpg"
            {% endif %}>   
        </img>
      </div>
    </div>
    <div class="col-sm-12 col-md-6">
      <div class="custom-column"> 
        <div id="map-container-google-9" class="z-depth-1-half map-container-5" 
            style="width: 100%; height: 400px;">
        </div>      
      </div>
    </div>
  </div>
</div>
<div class="jumbotron p-2">
    <div class="container.container-fluid">
        <div>
            <h2 class="h3">
                Pints:
            </h2>
        </div>
    </div>
</div>
<div class="row">
{% if beers %}
    <div class="col-xs-12 col-md-8 order-1 order-md-2">
        <div class="row">
            {% for beer in beers %}
            <div class="col-6 col-lg-4 mb-4">
                <div class="card-deck">
                    {% comment %} <a class="card-link" href="{% url 'macro_mate:meal' %}{{meal.id}}"> {% endcomment %}
                        <div class="card">
                            <div class="card-body">
                                <h3 class="h5 card-title">{{beer.beer.BeerName}}</h3>
                                <p class="card-text">Pint Price: {{beer.price_unit_verbose}}{{beer.price |floatformat:2 }}</p>
                                <div>
                                    <span class="badge badge-info">{{beer.beer.BeerBrand}}</span>
                                </div>
                                <p class="card-text"><small class="text-muted">Last updated
                                        {{beer.created_date}}</small>
                                </p>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <p>no prices added for this bar yet! </p>
    {% endif %}
</div>

    <script>
      // This sample uses the Place Autocomplete widget to allow the user to search
      // for and select a place. The sample then displays an info window containing
      // the place ID and other information about the place that the user has
      // selected.

      // This example requires the Places library. Include the libraries=places
      // parameter when you first load the API. For example:
      // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">
      

function initMap() {
        var map = new google.maps.Map(document.getElementById('map-container-google-9'), {
        center: new google.maps.LatLng(0, 0),
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        zoom: 15
    });
        google.maps.event.addListener(map, 'bounds_changed', function() {
        var bounds = map.getBounds();
        });
        var service = new google.maps.places.PlacesService(map);
        service.getDetails({
        placeId: '{{ bar.googleId }}'
    }, function (place, status) {
        if (status === google.maps.places.PlacesServiceStatus.OK) {

            // Create marker
            var marker = new google.maps.Marker({
                map: map,
                position: place.geometry.location
            });

            // Center map on place location
            map.setCenter(place.geometry.location);
            google.maps.event.trigger(map , 'resize');
            }
        }
      )}

    
</script>

<script src="https://maps.googleapis.com/maps/api/js?key={{ api_key }}&libraries=places&callback=initMap"
        async defer></script>

{% endblock %}